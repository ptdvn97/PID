#include <main.h>
#include <lcd.h>

#byte    QEICON= 0xFB6    // Thanh ghi dieu khien
int16    POSCNT; 
#byte    POSCNT= 0xF66  //Vi tri encoder
#byte    POSCNTH= 0xF67
#byte    POSCNTL= 0xF66
int16    MAXCNT;
#byte    MAXCNT= 0xF64  //POSCNT reset khi = MAXCNT
#byte    MAXCNTH= 0xF65
#byte    MAXCNTL= 0xF64


void tachSo(int16 xung)
{  
   unsigned int16 bien;
   unsigned int8 a,b,c,d;
   bien = xung; //256
   a = bien %10; // 6
   
   bien = bien/10; // 25
   b = bien%10; // 5
   
   bien = bien/10; // 2
   c = bien%10;
   
   lcd_gotoxy(1,2);
   printf(lcd_putc,"Respond: %d%d%d",c,b,a);
}

void main()
{
   QEICON   = 0x18;
   POSCNT = 0;
   MAXCNT  = 1440;
  int dv = 100;
  unsigned int16 pulse=0;
  lcd_init();
  lcd_gotoxy(1,1); // cot 1 dong 1
  lcd_putc('\f');
  printf(lcd_putc,"Value: %d",dv);
   while(TRUE)
   {
      tachSo(POSCNT/4);
   }
}





